type ERC20 @entity(immutable: true) {
  id: ID!
}
type Token @entity {
  id: ID!
  createdAt: BigInt!
  amount: BigInt!
  expiry: BigInt!
  ercToken: ERC20!
  status: BigInt!
  transactionHash: String!
  owner: Account!
  drawer: Account!
  recipient: Account!
  auditor: Account!
}
type Account @entity {
  id: ID!

  tokensOwned: [Token!]! @derivedFrom(field: "owner")
  numTokensOwned: BigInt!
  tokensSent: [Token!]! @derivedFrom(field: "drawer")
  numTokensSent: BigInt!
  tokensAuditing: [Token!]! @derivedFrom(field: "auditor")
  numTokensAuditing: BigInt!
  tokensReceived: [Token!]! @derivedFrom(field: "recipient")
  numTokensReceived: BigInt!

  tokensCashed: [Token!]!
  numTokensCashed: BigInt!
  tokensVoided: [Token!]!
  numTokensVoided: BigInt!

  voidedTokens: [Token!]!
  numVoidedTokens: BigInt!

  auditorsRequested: [Handshake!]! @derivedFrom(field: "userAccount")
  numAuditorsRequested: BigInt!
  usersRequested: [Handshake!]! @derivedFrom(field: "auditorAccount")
  numUsersRequested: BigInt!
}

type Handshake @entity {
  id: ID!

  userAccount: Account!
  userShake: Boolean!
  userLastShake: BigInt!

  auditorAccount: Account!
  auditorShake: Boolean!
  auditorLastShake: BigInt!

  completed: Boolean!
  lastCompleted: BigInt!
}
